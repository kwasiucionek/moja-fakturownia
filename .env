# =============================================================================
# FAKTUROWNIA - KONFIGURACJA PRODUKCYJNA (django-environ)
# =============================================================================
# Wypełnij wszystkie wartości przed wdrożeniem!

# =============================================================================
# KRYTYCZNE USTAWIENIA BEZPIECZEŃSTWA
# =============================================================================

# 🚨 ZMIEŃ TO! Wygeneruj nowy klucz: python manage.py shell -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
SECRET_KEY=django-insecure-0r!vdj6r+t*$*8$sb)^he#%lmg9@^!41j=a47t-gnv(@2_8r27

# NIGDY True w produkcji!
DEBUG=True

# Twoje dozwolone domeny (bez http/https)
ALLOWED_HOSTS=127.0.0.1

# =============================================================================
# BAZA DANYCH
# =============================================================================

# PostgreSQL (zalecane dla produkcji)
DATABASE_URL=postgresql://fakturownia_user:FakturowniA2024@mws02.mikr.us:51943/fakturownia_db

# SSL dla bazy danych (zalecane)
DB_SSLMODE=disable

# Connection pooling
DB_CONN_MAX_AGE=600
DB_CONN_HEALTH_CHECKS=True

# =============================================================================
# USTAWIENIA HTTPS I SSL
# =============================================================================

# Wymuszenie HTTPS
SECURE_SSL_REDIRECT=False
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True
SECURE_CONTENT_TYPE_NOSNIFF=True
SECURE_BROWSER_XSS_FILTER=True
SECURE_REFERRER_POLICY=strict-origin-when-cross-origin

# Proxy settings (dla load balancer/CDN)
SECURE_PROXY_SSL_HEADER=HTTP_X_FORWARDED_PROTO,https

# =============================================================================
# COOKIES I SESJE
# =============================================================================

# Bezpieczne cookies (tylko HTTPS)
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
CSRF_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Strict
CSRF_COOKIE_SAMESITE=Strict

# Długość sesji (8 godzin = 28800 sekund)
SESSION_COOKIE_AGE=28800

# CSRF zabezpieczenia
CSRF_COOKIE_NAME=csrftoken
CSRF_TRUSTED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# =============================================================================
# ADMIN I UWIERZYTELNIANIE
# =============================================================================

# 🚨 ZMIEŃ TO! Ukryty URL admin (użyj losowego)
ADMIN_URL=admin-abc123/

# Allauth settings
ACCOUNT_EMAIL_VERIFICATION=mandatory
ACCOUNT_EMAIL_REQUIRED=True
ACCOUNT_LOGIN_ATTEMPTS_LIMIT=5
ACCOUNT_LOGIN_ATTEMPTS_TIMEOUT=300
ACCOUNT_PASSWORD_MIN_LENGTH=14

# Google OAuth (opcjonalnie)
# GOOGLE_OAUTH_CLIENT_ID=your-client-id
# GOOGLE_OAUTH_CLIENT_SECRET=your-client-secret

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================

EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=kwasiek@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=Fakturownia <kwasiek@gmail.com>
SERVER_EMAIL=server@your-domain.com

# Email bezpieczeństwo
EMAIL_TIMEOUT=30
EMAIL_USE_SSL=False

# =============================================================================
# CACHE I REDIS
# =============================================================================

# Redis (silnie zalecane dla produkcji)
REDIS_URL=redis://:RedisPass2024@#@localhost:6379/1

# Cache settings
CACHE_KEY_PREFIX=fakturownia_prod
CACHE_TIMEOUT=300

# Session w cache
SESSION_ENGINE=django.contrib.sessions.backends.cached_db
SESSION_CACHE_ALIAS=default

# Rate limiting configuration
RATELIMIT_ENABLE=True


# =============================================================================
# PLIKI STATYCZNE I MEDIA
# =============================================================================

# Ścieżki (dostosuj do swojego serwera)
#STATIC_ROOT=/var/www/fakturownia/staticfiles
#MEDIA_ROOT=/var/www/fakturownia/media

# WhiteNoise settings
STATICFILES_STORAGE=whitenoise.storage.CompressedManifestStaticFilesStorage
WHITENOISE_MAX_AGE=31536000

# Upload limits
FILE_UPLOAD_MAX_MEMORY_SIZE=5242880
DATA_UPLOAD_MAX_MEMORY_SIZE=5242880
DATA_UPLOAD_MAX_NUMBER_FIELDS=100

# =============================================================================
# ZABEZPIECZENIA I RATE LIMITING
# =============================================================================

# Rate limiting
RATELIMIT_ENABLE=True
SECURITY_MAX_REQUESTS_PER_MINUTE=60
SECURITY_MAX_FAILED_LOGINS=5
SECURITY_BLOCK_DURATION=300

# IP whitelist (dodaj swoje IP)
SECURITY_IP_WHITELIST=127.0.0.1,::1

# Admin whitelist (opcjonalnie - dla dodatkowego bezpieczeństwa)
# ADMIN_IP_WHITELIST=1.2.3.4,5.6.7.8

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self','unsafe-inline'
CSP_STYLE_SRC='self','unsafe-inline',fonts.googleapis.com
CSP_FONT_SRC='self',fonts.gstatic.com
CSP_IMG_SRC='self',data:

# =============================================================================
# CORS (jeśli używasz API/frontend)
# =============================================================================

# CORS origins
CORS_ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com
CORS_ALLOW_CREDENTIALS=False

# =============================================================================
# LOGOWANIE
# =============================================================================

# Poziom logowania (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=WARNING

# Pliki logów
LOG_FILE=/var/log/fakturownia/app.log
SECURITY_LOG_FILE=/var/log/fakturownia/security.log

# =============================================================================
# MONITORING I BŁĘDY
# =============================================================================

# Sentry (monitoring błędów) - wysoce zalecane!
SENTRY_DSN=

# Sentry settings
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=1.0.0
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# =============================================================================
# BACKUP I PRZYWRACANIE
# =============================================================================

# Backup storage
DBBACKUP_STORAGE=django.core.files.storage.FileSystemStorage
DBBACKUP_STORAGE_OPTIONS={'location': '/var/backups/fakturownia'}

# GPG encryption dla backupów (zalecane)
# DBBACKUP_GPG_RECIPIENT=your-gpg-email@domain.com

# =============================================================================
# HEALTH CHECK
# =============================================================================

# Health check settings
HEALTH_CHECK_DISK_USAGE_MAX=90
HEALTH_CHECK_MEMORY_MIN=100

# =============================================================================
# USTAWIENIA APLIKACJI FAKTUROWNIA
# =============================================================================

# Format numerów faktur
INVOICE_NUMBER_FORMAT=F/{id}/{month}/{year}

# Domyślny termin płatności (dni)
DEFAULT_PAYMENT_DAYS=14

# Maksymalny rozmiar PDF faktury (MB)
MAX_INVOICE_PDF_SIZE=10

# =============================================================================
# LOKALIZACJA I STREFA CZASOWA
# =============================================================================

# Język aplikacji
LANGUAGE_CODE=pl

# Strefa czasowa
TIME_ZONE=Europe/Warsaw

# =============================================================================
# DODATKOWE USTAWIENIA BEZPIECZEŃSTWA
# =============================================================================

# Password validation
AUTH_PASSWORD_MIN_LENGTH=14

# Content length limits
SECURITY_MAX_CONTENT_LENGTH=10485760

# Google Fonts (False dla lepszego privacy)
USE_GOOGLE_FONTS_CDN=False

# =============================================================================
# ŚRODOWISKO I DEPLOYMENT
# =============================================================================

# Środowisko
ENVIRONMENT=production

# Wersja aplikacji
VERSION=1.0.0

# Enable API (jeśli potrzebne)
ENABLE_API=False

# =============================================================================
# DEVELOPMENT SETTINGS (USUŃ W PRODUKCJI!)
# =============================================================================

# Te ustawienia USUŃ lub ustaw na False w produkcji!
# DEBUG_TOOLBAR=False
# SHELL_PLUS_PRINT_SQL=False

# =============================================================================
# CUSTOM SECURITY HEADERS
# =============================================================================

# Dodatkowe nagłówki bezpieczeństwa
SECURITY_HEADERS_PERMISSIONS_POLICY=geolocation=(),microphone=(),camera=()
SECURITY_HEADERS_REFERRER_POLICY=strict-origin-when-cross-origin

# =============================================================================
# UWAGI I INSTRUKCJE
# =============================================================================

# 🚨 PRZED WDROŻENIEM:
# 1. Wygeneruj nowy SECRET_KEY
# 2. Zmień ADMIN_URL na losowy string
# 3. Ustaw prawdziwe domeny w ALLOWED_HOSTS i CSRF_TRUSTED_ORIGINS
# 4. Skonfiguruj hasło Redis
# 5. Ustaw hasło email (lub użyj zmiennych środowiskowych)
# 6. Skonfiguruj Sentry DSN
# 7. Dostosuj ścieżki STATIC_ROOT i MEDIA_ROOT
# 8. Usuń komentarze z development settings

# 🔒 BEZPIECZEŃSTWO:
# - Nigdy nie commituj tego pliku do git!
# - Użyj chmod 600 .env
# - Regularne zmieniaj SECRET_KEY
# - Monitoruj logi bezpieczeństwa

# 📝 TESTOWANIE:
# Uruchom: python security_check.py
# Sprawdź: python manage.py check --deploy
